define("localSiteSerializer",["lodash","coreUtils","utils"],function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=898)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},12:function(e,t){e.exports=n},898:function(e,t,n){var r,a;r=[n(0),n(899),n(907)],void 0===(a=function(e,t,n){"use strict";return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.plugins,o=void 0===a?Object.values(t):a,i=r.encodeWhenSerializing,s=void 0===i||i,u=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.encode,a=e.cloneDeep(t);return o.reduce(function(n,o){return o.getEncryptedPaths(a).forEach(function(a){var o=e.get(t,a);o&&e.set(n,a,r(o))}),n},a)},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.decode;return u(e,t)};return{serialize:function(t){var n=o.reduce(function(n,r){var a=r.serialize;return e.merge(n,a(t))},{});return s?u(n):n},deserialize:function(t){var n=s?c(t):t;return o.reduce(function(t,r){var a=r.deserialize;return e.merge(t,a(n))},{})},encode:u,decode:c}}}.apply(t,r))||(e.exports=a)},899:function(e,t,n){var r,a;r=[n(0),n(900),n(901),n(902),n(903),n(904),n(905),n(906)],void 0===(a=function(e,t,n,r,a,o,i,s){"use strict";return{styles:t,commonComponents:n,pages:r,menu:s,background:i,routers:o,siteInfo:a}}.apply(t,r))||(e.exports=a)},900:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.pagesData.masterPage.data.theme_data;return{styles:{colors:n.THEME_DATA.color,fonts:n.THEME_DATA.font,theme:e.omit(n.THEME_DATA,"color","font"),topLevelStyles:e.omit(n,"THEME_DATA")}}},deserialize:function(e){var t=e.styles;return{pagesData:{masterPage:{data:{theme_data:Object.assign({THEME_DATA:Object.assign({color:t.colors,font:t.fonts},t.theme)},t.topLevelStyles)}}}}},getEncryptedPaths:function(){return["styles.colors","styles.fonts","styles.theme","styles.topLevelStyles"]}}}.apply(t,r))||(e.exports=a)},901:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";var t={dataQuery:"document_data",connectionQuery:"connections_data",designQuery:"design_data",mobileHintsQuery:"mobile_hints",propertyQuery:"component_properties"},n=function(t){var n=e.get(t,"layout.anchors");return n&&Array.isArray(n)&&n.forEach(function(t){return e.unset(t,"locked")}),t};return{serialize:function(r){var a,o,i,s,u,c,d,p=r.pagesData,l=(a=p.masterPage,o=a.structure.children,i=o.concat(e(o).flatMapDeep("components").compact().value()),e.reduce(i,function(n,r){return e.forEach(t,function(t,o){var i=r[o]&&["data",t,r[o].replace("#","")],s=e.get(a,i);s&&(e.set(n,i,s),e.unset(a,i))}),n},{}));return{site:{commonComponents:Object.assign(n((s=p.masterPage.structure,u=e.findIndex(s.children,{id:"PAGES_CONTAINER"}),c=e.findIndex(s.children,{id:"SITE_FOOTER"}),d=e.get(s,"children["+u+"].layout.y"),e.set(s,"children["+u+"].layout.height",400),e.set(s,"children["+c+"].layout.y",400+d),s)),{extractedDataItems:l})}}},deserialize:function(t){return{pagesData:{masterPage:{structure:e.omit(t.site.commonComponents,"extractedDataItems"),data:e.get(t.site.commonComponents,"extractedDataItems.data",{})}}}},getEncryptedPaths:function(){return["site.commonComponents"]}}}.apply(t,r))||(e.exports=a)},902:function(e,t,n){var r,a;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";var t=function(e,t){return e?o({},t,e):{}};return{serialize:function(n){var r=n.pagesData,a=n.rendererModel;return{pages:Object.keys(r).filter(function(e){return"masterPage"!==e}).reduce(function(n,o){var i=r.masterPage.data.document_data[o],s=i.pageUriSEO,u=i.title,c=i.isPopup,d=i.id;return n[o]={pageUriSeo:s,title:u,isPopup:c,pageId:d,content:Object.assign({},r[o],t(e.get(a.pagesPlatformApplications,o),"pagesPlatformApplications"),t(a.passwordProtectedPages&&a.passwordProtectedPages.find(function(e){return e===o}),"passwordProtectedPages"))},e.unset(r.masterPage.data.document_data[o],"pageUriSEO"),e.unset(r.masterPage.data.document_data[o],"title"),n},{})}},deserialize:function(t){return{pagesData:Object.keys(t.pages).filter(function(e){return"masterPage"!==e}).reduce(function(n,r){var a;return Object.assign(n,(o(a={},r,Object.assign(t.pages[r].content,{title:t.pages[r].title,pageUriSEO:t.pages[r].pageUriSeo})),o(a,"masterPage",e.merge(n.masterPage,{data:{document_data:o({},r,{isPopup:t.pages[r].isPopup,title:t.pages[r].title,pageUriSEO:t.pages[r].pageUriSeo,id:t.pages[r].pageId})}})),a))},{}),rendererModel:Object.keys(t.pages).filter(function(e){return"masterPage"!==e}).reduce(function(e,n){var r=t.pages[n].content;return r.pagesPlatformApplications&&(e.pagesPlatformApplications[n]=r.pagesPlatformApplications),delete r.pagesPlatformApplications,e.passwordProtectedPages=e.passwordProtectedPages.concat(r.passwordProtectedPages?r.passwordProtectedPages:[]),delete r.passwordProtectedPages,e},{pagesPlatformApplications:{},passwordProtectedPages:[]})}},getEncryptedPaths:function(e){return Object.keys(e.pages).map(function(e){return"pages."+e+".content"})}}}.apply(t,r))||(e.exports=a)},903:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.pagesData,r=t.documentServicesModel,a=t.rendererModel,o=n.masterPage;return{site:Object.assign({},{siteInfo:a.siteInfo,version:{version:r.version,revision:r.revision},dataFromMasterPage:e.omit(o,"structure","data.theme_data")},a.multilingualInfo?{multilingualInfo:a.multilingualInfo}:{})}},deserialize:function(e){return{pagesData:{masterPage:e.site.dataFromMasterPage},documentServicesModel:Object.assign(e.site.version),rendererModel:Object.assign({siteInfo:e.site.siteInfo},e.site.multilingualInfo?{multilingualInfo:e.site.multilingualInfo}:{})}},getEncryptedPaths:function(){return["site.siteInfo","site.revision","site.version","site.dataFromMasterPage","site.multilingualInfo"]}}}.apply(t,r))||(e.exports=a)},904:function(e,t,n){var r,a;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.rendererModel,r=e.get(n,"routers.configMap",{});return{routers:Object.keys(r).reduce(function(e,t){return Object.assign(e,o({},r[t].prefix,Object.assign({},r[t],{routeId:t})))},{})}},deserialize:function(t){return{rendererModel:{routers:{configMap:Object.keys(t.routers).reduce(function(n,r){return e.merge(n,o({},t.routers[r].routeId,Object.assign({},e.omit(t.routers[r],"routeId"),{prefix:r})))},{})}}}},getEncryptedPaths:function(e){return Object.keys(e.routers).map(function(e){return"routers."+e})}}}.apply(t,r))||(e.exports=a)},905:function(e,t,n){var r,a;r=[n(0),n(12),n(1)],void 0===(a=function(e,t,n){"use strict";var r=t.siteUtils,a=function(t,n,a){return r.getPageBackgroundDataPointers(a,[n]).reduce(function(t,n){var r=n.path;return e.get(a,r)&&(e.set(t,r,e.get(a,r)),e.unset(a,r)),t},{})},o=function(t,n,a){return r.getPageBackgroundDataPointers(n.content,[a]).forEach(function(r){var a=r.path;e.get(n.content,a)&&(e.set(t,a,e.get(n.content,a)),e.unset(n.content,a))}),t};return{serialize:function(t){var r=t.pagesData,o=r[n.siteConstants.MASTER_PAGE_ID];return{pages:e(r).omit("masterPage").mapValues(function(e,t){return{content:a(0,t,o)}}).value()}},deserialize:function(t){var n=t.pages;return{pagesData:{masterPage:e(n).omit("masterPage").reduce(o,{data:{document_data:{}}})}}},getEncryptedPaths:function(e){return Object.keys(e.pages).map(function(e){return"pages."+e+".content"})}}}.apply(t,r))||(e.exports=a)},906:function(e,t,n){var r,a;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";var t=["PageLink","AnchorLink"],n=function(e){return e.replace(/^#/,"")};return{serialize:function(r){var a=r.pagesData,o=a.masterPage.data.document_data,i=function(t){return e(t).mapValues().filter(["type","CustomMenusCollection"]).flatMap("menus").map(n).value()}(o);return e.reduce(i,function(r,i){var s=function(t,r){return e.flattenDeep(function r(a){var o=a.dataId,i=a.parent,s=void 0===i?null:i,u=a.index,c=void 0===u?0:u,d="data.document_data."+o.replace("#",""),p=[],l=e.get(t,d+".items");return l.length>0&&p.push(l.map(function(e,t){return r({dataId:e,parent:n(o),index:t})})),p.concat([{path:d,parent:s,index:c}])}({dataId:r}))}(a.masterPage,i),u=function(r,a){return e.reduce(a,function(a,o){var i=o.path,s=o.index,u=o.parent,c=e.get(r,i);if(c.link){var d=e.get(r,"data.document_data."+c.link.replace("#","")),p=Object.assign({data:c},{linkItem:d,index:s,parent:u});t.includes(d.type)?a.pagesRelatedItems[n(d.pageId)]=p:a.nonPagesRelatedItems[c.id]=p}return a},{pagesRelatedItems:{},nonPagesRelatedItems:{}})}(a.masterPage,s),c=u.pagesRelatedItems,d=u.nonPagesRelatedItems;return e.forEach(c,function(t,a){e.set(r.pages,[a,"content","menus",i,t.data.id],e.omit(t,"data.items")),e.unset(o,t.data.id),t.data.link&&e.unset(o,n(t.data.link))}),r.menus[i]={data:e.omit(e.get(o,i),"items"),items:d},e(d).keys().forEach(function(t){e.unset(o,t)}),r},{menus:{},pages:{}})},deserialize:function(t){var r=Object.keys(t.menus).reduce(function(n,r){return Object.assign(n,o({},r,e.merge({},o({},r,t.menus[r].data),t.menus[r].items,e.reduce(t.pages,function(t,n){return e.assign(t,n.content.menus?n.content.menus[r]:{})},{}))))},{});return{pagesData:{masterPage:{data:{document_data:e(r).keys().reduce(function(t,a){return Object.assign(t,function(t){var r=t.menuType,a=t.menuItems;function i(t){return e(a).filter(["parent",t]).orderBy(function(e){return e.index}).value()}var s=a[r],u=i(r).reduce(function(e,t){return Object.assign(e,t.linkItem?o({},t.linkItem.id,t.linkItem):{},o({},t.data.id,Object.assign(t.data,{items:[]})),o({},r,Object.assign(e[r],{items:e[r].items.concat("#"+t.data.id)})))},o({},r,Object.assign(s,{items:[]})));return e.flatMap(s.items.map(n).map(i)).reduce(function(t,n){return Object.assign(t,n.linkItem?o({},n.linkItem.id,n.linkItem):{},o({},n.data.id,n.data),o({},n.parent,Object.assign(t[n.parent],{items:e.get(t[n.parent],"items",[]).concat("#"+n.data.id)})))},u)}({menuType:a,menuItems:r[a]}))},{})}}}}},getEncryptedPaths:function(t){return e(t.menus).keys().map(function(e){return"menus."+e}).concat(e(t.pages).keys().map(function(e){return"pages."+e+".content.menus"}).value()).value()}}}.apply(t,r))||(e.exports=a)},907:function(e,t,n){var r,a;r=[n(0),n(908)],void 0===(a=function(e,t){"use strict";return{encode:function(n){return e.flow([t,encodeURIComponent,unescape,btoa])(n)},decode:function(t){return e.flow([atob,escape,decodeURIComponent,JSON.parse])(t)}}}.apply(t,r))||(e.exports=a)},908:function(e,t,n){var r,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};void 0===(r=function(){"use strict";return function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n=t.space||"";"number"==typeof n&&(n=Array(n+1).join(" "));var r,o="boolean"==typeof t.cycles&&t.cycles,i=t.replacer||function(e,t){return t},s=t.cmp&&(r=t.cmp,function(e){return function(t,n){var a={key:t,value:e[t]},o={key:n,value:e[n]};return r(a,o)}}),u=[];return function e(t,r,c,d){var p=n?"\n"+new Array(d+1).join(n):"",l=n?": ":":";if(c&&c.toJSON&&"function"==typeof c.toJSON&&(c=c.toJSON()),void 0!==(c=i.call(t,r,c))){if("object"!==(void 0===c?"undefined":a(c))||null===c)return JSON.stringify(c);if(Array.isArray(c)){for(var f=[],g=(c.sort(function(e,t){return e.id>=t.id}),0);g<c.length;g++){var m=e(c,g,c[g],d+1)||JSON.stringify(null);f.push(p+n+m)}return"["+f.join(",")+p+"]"}if(-1!==u.indexOf(c)){if(o)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}u.push(c);for(var v=Object.keys(c).sort(s&&s(c)),y=[],P=0;P<v.length;P++){var b=e(c,r=v[P],c[r],d+1);if(b){var O=JSON.stringify(r)+l+b;y.push(p+n+O)}}return u.splice(u.indexOf(c),1),"{"+y.join(",")+p+"}"}}({"":e},"",e,0)}}.apply(t,[]))||(e.exports=r)}})});
//# sourceMappingURL=localSiteSerializer.min.js.map